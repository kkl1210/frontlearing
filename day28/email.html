<html>

<head>
    <style>
        ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }
    </style>
</head>

<body>
    <div class="wrapper">
        <input id="email-input" type="text" oninput="getInputVaule()">
        <ul id="email-sug-wrapper" class="email-sug"></ul>
    </div>
    <script>
        let ul = document.querySelector("ul");

        // //输入监听
        // document.getElementById("email-input").addEventListener("focus", input, false);

        // function input() {
        //     console.log("the inputarea is focus");
        //     listContent();
        //     showControll();
        // }

        //获取用户输入
        function getInputVaule() {
            let inputbox = document.getElementById("email-input");
            let inputvalue = inputbox.value.trim();
            // inputvalue = encode(inputvalue);
            listContent(inputvalue);
            const boxwidth = inputbox.clientWidth;
            ul.style.border = "1px solid #ECD9C8";
            ul.style.width = boxwidth;

        }
        //生成提示框中的提示内容
        function listContent(inputvalue) {
            let index = inputvalue.indexOf('@');
            let lastfix;
            if (index !== -1) {
                lastfix = inputvalue.slice(index + 1);
                inputvalue = inputvalue.slice(0, index);

            }
            //遍历postFixList
            ul.innerHTML = '';
            if (inputvalue === '') {
                return;
            }
            var postfixList = ['163.com', 'gmail.com', '126.com', 'qq.com', '263.net'];
            let fixarr = [];
            for (item in postfixList) {

                if (postfixList[item].indexOf(lastfix) === 0) {
                    fixarr.push(postfixList[item]);
                }
            }
            if (fixarr.length === 0) {
                fixarr = postfixList;
            }
            for (item in fixarr) {
                let li = document.createElement("li");
                // inputvalue = decode(inputvalue);
                li.textContent = inputvalue + '@' + fixarr[item];
                li.addEventListener("click", clickAndAdd, false);
                ul.appendChild(li);
            }

        }

        function showControll() {
            let value = getInputVaule();
            if (value === "") {
                show();
            }
            hide();
        }

        function show() {
            let ul = document.querySelector('ul');
            ul.style.display = block;
        }

        function hide() {
            let ul = document.querySelector('ul');
            ul.style.display = none;

        }
        //点击添加到输入框
        function clickAndAdd() {
            console.log('click');
            let value = this.innerHTML;
            value = decode(value);
            // console.log(this.innerHTML);
            document.getElementById("email-input").value = value;
            ul.innerHTML = '';
        }
        //编码
        function encode(inputvalue) {
            let temp = document.createElement('div');
            temp.innerText = inputvalue;
            let output = temp.innerHTML;
            temp = null;
            return output;

        }
        //解码
        function decode(inputvalue) {
            let temp = document.createElement('div');
            temp.innerHTML = inputvalue;
            let output = temp.innerText;
            temp = null;
            return output;
        }
    </script>

</body>

</html>